<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Material Design for Bootstrap fonts and icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">

    <!-- Material Design for Bootstrap CSS -->
    <!-- <link rel="stylesheet" href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css" integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.19.0/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.19.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.19.0/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.19.0/firebase-firestore.js"></script>


    <style>
        .checked {
  color: orange;
}
    </style>
    <title>Covid-19 Keeper</title>
  </head>
  <body>
    <script>
        var info={

            timeOpened:new Date(),
            timezone:(new Date()).getTimezoneOffset()/60,

            pageon(){return window.location.pathname},
            referrer(){return document.referrer},
            previousSites(){return history.length},

            browserName(){return navigator.appName},
            browserEngine(){return navigator.product},
            browserVersion1a(){return navigator.appVersion},
            browserVersion1b(){return navigator.userAgent},
            browserLanguage(){return navigator.language},
            browserOnline(){return navigator.onLine},
            browserPlatform(){return navigator.platform},
            javaEnabled(){return navigator.javaEnabled()},
            dataCookiesEnabled(){return navigator.cookieEnabled},
            dataCookies1(){return document.cookie},
            dataCookies2(){return decodeURIComponent(document.cookie.split(";"))},
            dataStorage(){return localStorage},

            sizeScreenW(){return screen.width},
            sizeScreenH(){return screen.height},
            sizeDocW(){return document.width},
            sizeDocH(){return document.height},
            sizeInW(){return innerWidth},
            sizeInH(){return innerHeight},
            sizeAvailW(){return screen.availWidth},
            sizeAvailH(){return screen.availHeight},
            scrColorDepth(){return screen.colorDepth},
            scrPixelDepth(){return screen.pixelDepth},


            latitude(){return position.coords.latitude},
            longitude(){return position.coords.longitude},
            accuracy(){return position.coords.accuracy},
            altitude(){return position.coords.altitude},
            altitudeAccuracy(){return position.coords.altitudeAccuracy},
            heading(){return position.coords.heading},
            speed(){return position.coords.speed},
            timestamp(){return position.timestamp},
            };

        // Your web app's Firebase configuration
        var firebaseConfig = {
          apiKey: "AIzaSyCZPlNpVnYwUzkENxRQ4_t0_gulkUoh19g",
          authDomain: "covid19-c8864.firebaseapp.com",
          databaseURL: "https://covid19-c8864.firebaseio.com",
          projectId: "covid19-c8864",
          storageBucket: "covid19-c8864.appspot.com",
          messagingSenderId: "848569204691",
          appId: "1:848569204691:web:11902404f5387163557926",
          measurementId: "G-WWPVFZSH0N"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();

        const db = firebase.firestore();
        const messaging = firebase.messaging();

        function requestNotification(){ 
            // Get Instance ID token. Initially this makes a network call, once retrieved
            // subsequent calls to getToken will return from cache.
            messaging.getToken().then((currentToken) => {
            if (currentToken) { 
                console.log(currentToken);

                var userInfo = {
                    timeOpened:new Date(),
                    timezone:(new Date()).getTimezoneOffset()/60,
                    token: currentToken,
                    referrer: document.referrer,
                    browserName: navigator.appName,
                    browserEngine: navigator.product,
                    browserPlatform: navigator.platform,
                    browserLanguage: navigator.language,
                    appVersion: navigator.appVersion,
                    userAgent: navigator.userAgent,
                    sizeScreenW: screen.width,
                    sizeScreenH: screen.height,

                };
                try { 
                    userInfo['latitude'] = position.coords.latitude;
                    userInfo['longitude'] = position.coords.longitude;
                } catch(err) { }

                db.collection("users").add(userInfo)
                .then(function(docRef) {
                    // console.log("Document written with ID: ", docRef.id);
                })
                .catch(function(error) {
                    // console.error("Error adding document: ", error);
                });

                // location.href=document.referrer;

            } else {
                // Show permission request.
                console.log('No Instance ID token available. Request permission to generate one.');
            }
            }).catch((err) => {
                console.log('An error occurred while retrieving token. ', err);
            });
        }
      </script>
    <div class="container p-0" >
        <!-- <div class="row"  style="height:200px" >  -->
        <div class="row pt-4" > 
            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <!-- <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li> -->
                    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                </ol>
                <div class="carousel-inner">
                    <!-- <div class="carousel-item active">
                    <img class="d-block w-100" src="resources/covidmap2.svg" alt="First slide">
                    </div> -->
                    <div class="carousel-item active" >
                        <!-- <img class="d-block w-100" src="resources/covidmap2.svg" alt="Second slide"> -->
                        <img class="d-block w-100 p-4" src="resources/map.jpg" alt="Live map">

                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100 p-4" src="resources/phone.jpg" alt="My location">
                    </div>
                    
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>

                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
                </div>
        </div>
        <div class="row pt-2 pl-5 pr-5"  >
            <main role="main" class="inner cover">
                <h3 class="cover-heading  text-center">Corona Watcher <i class="fas fa-bullseye p-2" style="opacity:0.3"></i>  </h3>

                <h6 class="text-center text-muted"><small >
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star"></span>
                    103,245
                    <span class="fa fa-user"></span>
                </small>
            </h6>
                <p></p>
                <!-- <h5 class="lead  text-center">Corona Watcher will notify you when an identified Covid-19 case is near you.</h5> -->
                <h5 class="lead  text-center">Get notified when a COVID-19 case is found near you.</h5>

                <p></p>
                <!-- <h6 class="lead text-muted text-center">Fast. Accurate. Simple.</h6> -->
                <h6 class="lead text-muted text-center">Accurate. Simple. Free.</h6>

                <!-- <h2 class="lead text-center">
                  <a href="#" class="btn btn-primary" style="text-transform: none;">Keep me safe</a>
                </h2> -->
                <p></p>
                <h6 class="text-center">
                    <!-- <a href="#" class="btn btn-primary btn-lg active" role="button" aria-pressed="true" style="text-transform: none;">Keep me safe</a>
                    <a href="#" class="ml-2" variant="contained" role="button" aria-pressed="true" style="text-transform: none;">Later</a> -->
                    <!-- <a href="#" class="btn btn-primary btn-lg active" role="button" aria-pressed="true">Keep Safe</a> -->
                    <!-- <a href="#" class="btn btn-secondary btn-lg" role="button" aria-pressed="true">Later</a> -->
                    <button type="button" class="btn btn-lg btn-primary active" onclick="requestNotification()">Keep safe</button>

                    <button type="button" class="btn btn-lg btn-outline-secondary"  onclick="requestNotification()">No thanks</button>

                </h5>
                <!-- <a href="#" class="btn btn-primary btn-lg active" role="button" aria-pressed="true">Primary link</a>
                <a href="#" class="btn btn-secondary btn-lg active" role="button" aria-pressed="true">Link</a> -->
              </main>
        </div>
        <!-- <i class="fas fa-lock"></i>  -->
        <footer>
            <small class="text-muted p-4">You may choose to disable this feature at any time.</small>

            <!-- <small class="text-muted p-4">(c) Harvard research</small> -->

        </footer>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js" integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js" integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9" crossorigin="anonymous"></script>
    <script>$(document).ready(function() { $('body').bootstrapMaterialDesign(); });</script>
  </body>
</html>